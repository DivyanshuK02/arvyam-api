# Deploy — Render Web Service (minimal)

This project deploys as a **Render Web Service**. Keep deployment knobs out of README to avoid drift; this page is the single source for deploy basics.

## Service settings
- **Service type:** Web Service
- **Runtime:** Python 3.11
- **Region:** (choose closest to your users)
- **Auto-deploy:** From `main` branch (recommended)

## Commands
**Build:**
```bash
pip install -r requirements.txt
```

**Start:**
```bash
uvicorn app.main:app --host 0.0.0.0 --port $PORT
```

> Render supplies `$PORT`. No other env vars are required for v1.

## Notes
- Public API v1 is **packaging-blind**: no `packaging` or `luxury_grand` leaves the server.
- CI must be green before deploy (contract + guards + golden harness).
- Rollback = deploy a prior commit from Render’s “Manual Deploy” (no code changes needed).

## Pre-deploy checklist
- `pytest -q` passes locally.
- Evidence/artifacts generated by the golden harness (optional for prod).
- No changes to public schema (v1 freeze).
---

## Phase-1 §1.6 — Catalog Schema Freeze (notes)

### Public API allow-list (v1)
Return only these keys per item:
`id`, `title`, `desc`, `image`, `price`, `currency`, `emotion`, `tier`, `mono`, `palette`
Optional: `note`, `edge_case`, `edge_type`

### Strictly forbidden to leak
`packaging`, `luxury_grand`, `image_url`, `price_inr`, `flowers`, `weight`, `tags`, and any private/underscored keys.

**LLM Feeder Note:** Fields like `tags/flowers/packaging/...` are for **LLM feeder and internal tooling only**. They are not part of the public API and must **never** be surfaced by `/api/curate`.

### Sobriety note — grief/farewell
For sympathy/farewell families, palettes must stay muted and respectful.
Gold accents are acceptable in moderation; celebratory/neon tones are blocked by tests/policy.

### CI ordering (post-P1.6)
1. Rulebook validation  
2. Catalog JSON-schema validation (this phase)  
3. Test suite (contract, golden harness, boundaries/fallbacks)

### Phase flag
`docs/phase_status.json` carries `"1.6_catalog_schema": "frozen"`.
